print 'CREATING <%= @ctx[:coh_cluster_name] %> COHERENCE CLUSTER';

connect('<%= node[:weblogic][:user] %>','<%= node[:weblogic][:password] %>','t3://<%= node[:weblogic][:domain_name] %>:<%= node[:weblogic][:port] %>')
edit()
startEdit()
cmo.createCoherenceClusterSystemResource('<%= @ctx[:coh_cluster_name] %>')
cd('/CoherenceClusterSystemResources/<%= @ctx[:coh_cluster_name] %>')
set('Targets',jarray.array([ObjectName('com.bea:Name=<%= @ctx[:server_name] %>.join(','),Type=Server')],ObjectName))
cd('Resource/<%= @ctx[:coh_cluster_name] %>/CoherenceClusterParams/<%= @ctx[:coh_cluster_name] %>')
cmo.setUnicastPortAutoAdjust(<%= @ctx[:coh_cluster_unicast_port_autoadjust] %>)
cmo.setUnicastListenAddress('<%= @ctx[:coh_cluster_unicast_address] %>')
cmo.setUnicastListenPort(<%= @ctx[:coh_cluster_unicast_port] %>)
activate()
disconnect()
exit()
